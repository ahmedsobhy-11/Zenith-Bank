{% extends "base.html" %}

{% block title %}Transaction History | Zenith{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<style>
    .history-wrapper {
        background: rgba(255, 255, 255, 0.06);
        border-radius: 16px;
        padding: 40px;
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 1px solid var(--border-light);
        box-shadow: 0 25px 60px rgba(0,0,0,0.2);
    }
    
    .history-header {
        margin-bottom: 30px;
    }

    .history-header h2 {
        font-size: 28px;
        letter-spacing: 1px;
    }

    .history-table {
        width: 100%;
        border-collapse: collapse;
    }

    .history-table th, .history-table td {
        padding: 16px 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    .history-table th {
        color: var(--text-muted);
        text-transform: uppercase;
        font-size: 13px;
        letter-spacing: 1px;
    }

    .type-badge {
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 600;
        background: rgba(59, 130, 246, 0.15);
        color: #60a5fa;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .amount-positive { color: #22c55e; font-weight: bold; }
    .amount-negative { color: #ef4444; font-weight: bold; }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-page">
    <aside class="sidebar">
        <div class="sidebar-title">{{ bank_name }}</div>
        <ul class="sidebar-menu">
            <li><a href="/dashboard"><i class="fas fa-user"></i> Profile</a></li>
            <li><a href="/transfer"><i class="fas fa-arrow-up-right-from-square"></i> Money Transfer</a></li>
            <li><a href="/loan"><i class="fas fa-coins"></i> Loans</a></li>
            <li><a href="/history" class="active"><i class="fas fa-chart-line"></i> Transaction History</a></li>
            <li><a href="#"><i class="fas fa-credit-card"></i> Virtual Cards</a></li>
            <li><a href="#"><i class="fas fa-file-invoice"></i> Bill Payments</a></li>
            <li><a href="/logout"><i class="fas fa-lock"></i> Logout</a></li>
        </ul>
    </aside>

    <main class="dashboard-main">
        <div class="history-wrapper fade-in">
            <div class="history-header">
                <h2>Complete Audit Trail</h2>
                <p class="text-muted">A chronological ledger of all financial movements across your accounts and virtual cards.</p>
            </div>
            
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Date & Time</th>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tx in transactions %}
                    <tr>
                        <td>{{ tx.created_at.strftime("%Y-%m-%d %H:%M:%S") }}</td>
                        <td><span class="type-badge">{{ tx.transaction_type }}</span></td>
                        <td>{{ tx.description }}</td>
                        <td class="{{ 'amount-positive' if tx.amount > 0 else 'amount-negative' }}">
                            {% if tx.amount > 0 %}+{% endif %}${{ tx.amount|string|replace('-', '') }}
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="4" style="text-align: center; color: var(--text-muted); padding: 40px;">No transactions found in the ledger.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </main>
</div>
{% endblock %}